@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  /* Default theme (blue light) - will be overridden by ThemeContext */
  --bg: #f8fafc;
  --bg-secondary: #f1f5f9;
  --text: #1e293b;
  --text-muted: #64748b;
  --board-bg: #ffffff;
  --cell-bg: #ffffff;
  --cell-hover: #f1f5f9;
  --cell-selected: #bfdbfe;
  --cell-peer: #e0e7ff;
  --cell-primary: #93c5fd;
  --cell-secondary: #bfdbfe;
  --border-strong: #1e293b;
  --border-light: #cbd5e1;
  --text-given: #1e293b;
  --text-entered: #2563eb;
  --text-candidate: #94a3b8;
  --btn-bg: #f1f5f9;
  --btn-hover: #e2e8f0;
  --btn-active: #2563eb;
  --btn-active-text: #ffffff;
  --accent: #2563eb;
  --accent-light: #dbeafe;

  /* Spacing */
  --spacing-xs: 0.25rem;
  --spacing-sm: 0.5rem;
  --spacing-md: 1rem;
  --spacing-lg: 1.5rem;
  --spacing-xl: 2rem;

  /* Border radius */
  --radius-sm: 0.375rem;
  --radius-md: 0.5rem;
  --radius-lg: 0.75rem;
  --radius-xl: 1rem;
  --radius-2xl: 1.5rem;
  --radius-full: 9999px;

  /* Board specific */
  --board-radius: 0.75rem;
  --board-max-width-mobile: min(95vw, 26rem);
  --board-max-width-sm: 28rem;
  --board-max-width-md: 32rem;
  --board-max-width-lg: 36rem;
  --board-max-width-xl: 40rem;

  /* Font sizes - defaults, overridden by ThemeContext based on fontSize setting */
  --cell-font-size: 1.125rem;
  --cell-font-size-sm: 1.375rem;
  --cell-font-size-md: 1.625rem;
  --cell-font-size-lg: 1.875rem;
  --cell-font-size-xl: 2.125rem;
  --candidate-font-size: 8px;
  --candidate-font-size-sm: 9px;
  --candidate-font-size-md: 11px;
  --candidate-font-size-lg: 12px;
  --candidate-font-size-xl: 14px;
  --control-btn-size: 3rem;
  --control-font-size: 1.125rem;

  /* Legacy font sizes (for non-board elements) */
  --font-xs: 0.75rem;
  --font-sm: 0.875rem;
  --font-base: 1rem;
  --font-lg: 1.125rem;
  --font-xl: 1.25rem;
  --font-2xl: 1.5rem;

  /* Shadows */
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
  --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);

  /* Duplicate cell colors */
  --duplicate-bg-light: #fecaca;
  --duplicate-bg-dark: rgba(127, 29, 29, 0.5);
  --duplicate-text-light: #dc2626;
  --duplicate-text-dark: #f87171;

  /* Elimination colors */
  --elimination-text-light: #ef4444;
  --elimination-text-dark: #f87171;
}

html, body {
  background-color: var(--bg);
  color: var(--text);
  @apply antialiased;
  /* Prevent scroll and fix mobile viewport issues */
  overflow: hidden;
  height: 100vh;
  height: 100dvh; /* Dynamic viewport height for mobile */
  margin: 0;
  padding: 0;
}

/* Hide scrollbar but allow scrolling */
.scrollbar-hide {
  -ms-overflow-style: none;  /* IE and Edge */
  scrollbar-width: none;  /* Firefox */
}

.scrollbar-hide::-webkit-scrollbar {
  display: none;  /* Chrome, Safari and Opera */
}

/* Transitions moved to end of file with prefers-reduced-motion support */

/* Game container - wraps board and controls for consistent centering */
.game-container {
  width: 100%;
  max-width: var(--board-max-width-mobile);
}

@media (min-width: 640px) {
  .game-container {
    max-width: var(--board-max-width-sm);
  }
}

@media (min-width: 768px) {
  .game-container {
    max-width: var(--board-max-width-md);
  }
}

@media (min-width: 1024px) {
  .game-container {
    max-width: var(--board-max-width-lg);
  }
}

@media (min-width: 1280px) {
  .game-container {
    max-width: var(--board-max-width-xl);
  }
}

:root.font-large .game-container {
  max-width: min(98vw, 28rem);
}

@media (min-width: 640px) {
  :root.font-large .game-container {
    max-width: 30rem;
  }
}

@media (min-width: 768px) {
  :root.font-large .game-container {
    max-width: 36rem;
  }
}

@media (min-width: 1024px) {
  :root.font-large .game-container {
    max-width: 40rem;
  }
}

@media (min-width: 1280px) {
  :root.font-large .game-container {
    max-width: 44rem;
  }
}

/* Sudoku board styling */
.sudoku-board {
  display: grid;
  grid-template-columns: repeat(9, 1fr);
  border: 2px solid var(--border-strong);
  background-color: var(--board-bg);
  border-radius: var(--board-radius);
  overflow: hidden;
  width: 100%;
  max-width: var(--board-max-width-mobile);
  aspect-ratio: 1;
}

@media (min-width: 640px) {
  .sudoku-board {
    max-width: var(--board-max-width-sm);
  }
}

@media (min-width: 768px) {
  .sudoku-board {
    max-width: var(--board-max-width-md);
  }
}

@media (min-width: 1024px) {
  .sudoku-board {
    max-width: var(--board-max-width-lg);
  }
}

@media (min-width: 1280px) {
  .sudoku-board {
    max-width: var(--board-max-width-xl);
  }
}

/* Large font size makes board larger on mobile */
:root.font-large .sudoku-board {
  max-width: min(98vw, 28rem);
}

@media (min-width: 640px) {
  :root.font-large .sudoku-board {
    max-width: 30rem;
  }
}

@media (min-width: 768px) {
  :root.font-large .sudoku-board {
    max-width: 36rem;
  }
}

@media (min-width: 1024px) {
  :root.font-large .sudoku-board {
    max-width: 40rem;
  }
}

@media (min-width: 1280px) {
  :root.font-large .sudoku-board {
    max-width: 44rem;
  }
}

/* Controls container - takes full width of parent game-container */
.controls-container {
  width: 100%;
}

/* Cell styling */
.sudoku-cell {
  display: flex;
  align-items: center;
  justify-content: center;
  aspect-ratio: 1;
  cursor: pointer;
  box-sizing: border-box;
  font-weight: 600;
  font-size: var(--cell-font-size);
  /* Improve touch targets */
  min-height: 32px;
  min-width: 32px;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

@media (min-width: 640px) {
  .sudoku-cell {
    font-size: var(--cell-font-size-sm);
    min-height: 40px;
    min-width: 40px;
  }
}

@media (min-width: 768px) {
  .sudoku-cell {
    font-size: var(--cell-font-size-md);
    min-height: 44px;
    min-width: 44px;
  }
}

@media (min-width: 1024px) {
  .sudoku-cell {
    font-size: var(--cell-font-size-lg);
    min-height: 48px;
    min-width: 48px;
  }
}

@media (min-width: 1280px) {
  .sudoku-cell {
    font-size: var(--cell-font-size-xl);
    min-height: 52px;
    min-width: 52px;
  }
}

/* Candidate grid */
.candidate-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-template-rows: repeat(3, 1fr);
  width: 100%;
  height: 100%;
  padding: 1px;
}

@media (min-width: 640px) {
  .candidate-grid {
    padding: 2px;
  }
}

.candidate-digit {
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: var(--candidate-font-size);
  font-weight: 500;
  line-height: 1;
}

@media (min-width: 640px) {
  .candidate-digit {
    font-size: var(--candidate-font-size-sm);
  }
}

@media (min-width: 768px) {
  .candidate-digit {
    font-size: var(--candidate-font-size-md);
  }
}

@media (min-width: 1024px) {
  .candidate-digit {
    font-size: var(--candidate-font-size-lg);
  }
}

@media (min-width: 1280px) {
  .candidate-digit {
    font-size: var(--candidate-font-size-xl);
  }
}

/* ============================================================
   MOBILE TOUCH-FRIENDLY NUMBER PAD
   ============================================================ */

/* Control digit buttons - compact for better fit */
.control-digit-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  aspect-ratio: 1;
  width: 3.25rem;
  min-width: 3.25rem;
  min-height: 3.25rem;
  border-radius: 0.375rem;
  font-size: 1.25rem;
  font-weight: 600;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  user-select: none;
}

/* Mobile sizes */
@media (max-width: 639px) {
  .control-digit-btn {
    width: 3.5rem;
    min-width: 3.5rem;
    min-height: 3.5rem;
    font-size: 1.375rem;
  }

  /* Larger for large font size */
  :root.font-large .control-digit-btn {
    width: 4rem;
    min-width: 4rem;
    min-height: 4rem;
    font-size: 1.5rem;
  }
}

@media (min-width: 640px) {
  .control-digit-btn {
    width: 3.75rem;
    min-width: 3.75rem;
    min-height: 3.75rem;
    font-size: 1.5rem;
  }
}

/* Action buttons (notes, erase, undo, redo) */
.control-action-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0.75rem;
  border-radius: 0.5rem;
  font-size: 1.25rem;
  min-width: 44px;
  min-height: 44px;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  user-select: none;
}

@media (max-width: 639px) {
  .control-action-btn {
    min-width: 48px;
    min-height: 48px;
    font-size: 1.375rem;
  }

  :root.font-large .control-action-btn {
    min-width: 56px;
    min-height: 56px;
    font-size: 1.5rem;
  }
}

/* Compact action buttons for single row layout (Notes, Delete, Undo, Redo) */
/* Width calculated to match 3x3 digit grid: (3 * digit_width + 2 * gap) = (4 * action_width + 3 * gap) */
.control-action-btn-compact {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0.5rem;
  border-radius: 0.375rem;
  font-size: 1rem;
  width: 2.375rem;
  min-width: 2.375rem;
  min-height: 2.375rem;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  user-select: none;
}

@media (max-width: 639px) {
  .control-action-btn-compact {
    /* Match mobile digit buttons: 3*3.5 + 2*0.5 = 11.5rem, so 4*x + 3*0.5 = 11.5, x = 2.5rem */
    width: 2.5rem;
    min-width: 2.5rem;
    min-height: 2.5rem;
    padding: 0.5rem;
    font-size: 1rem;
  }

  :root.font-large .control-action-btn-compact {
    /* Match large font digit buttons: 3*4 + 2*0.5 = 13rem, so 4*x + 3*0.5 = 13, x = 2.875rem */
    width: 2.875rem;
    min-width: 2.875rem;
    min-height: 2.875rem;
    padding: 0.5rem;
    font-size: 1.125rem;
  }
}

@media (min-width: 640px) {
  .control-action-btn-compact {
    /* Match sm digit buttons: 3*3.75 + 2*0.625 = 12.5rem, so 4*x + 3*0.625 = 12.5, x = 2.656rem â‰ˆ 2.625rem */
    width: 2.625rem;
    min-width: 2.625rem;
    min-height: 2.625rem;
    padding: 0.5rem;
  }
}

/* Action buttons with text labels (shown on larger screens) */
.control-action-btn-labeled {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 0.125rem;
  padding: 0.5rem 0.75rem;
  border-radius: 0.5rem;
  min-width: 44px;
  min-height: 44px;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  user-select: none;
}

@media (max-width: 639px) {
  .control-action-btn-labeled {
    min-width: 48px;
    min-height: 48px;
    padding: 0.625rem;
  }

  :root.font-large .control-action-btn-labeled {
    min-width: 56px;
    min-height: 56px;
  }
}

@media (min-width: 640px) {
  .control-action-btn-labeled {
    min-width: 56px;
    min-height: 52px;
    padding: 0.375rem 0.75rem;
    gap: 0.125rem;
  }
}

/* Remaining count badge on digit buttons */
.digit-remaining-badge {
  position: absolute;
  bottom: -2px;
  right: -2px;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 1rem;
  height: 1rem;
  border-radius: 9999px;
  font-size: 0.625rem;
  font-weight: 600;
}

@media (min-width: 640px) {
  .digit-remaining-badge {
    width: 1.125rem;
    height: 1.125rem;
    font-size: 0.6875rem;
  }
}

/* Font size selector buttons */
.font-size-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0.25rem 0.5rem;
  border-radius: 0.375rem;
  font-weight: 500;
  min-height: 32px;
}

.font-size-btn-xs {
  font-size: 0.625rem;
}

.font-size-btn-small {
  font-size: 0.75rem;
}

.font-size-btn-medium {
  font-size: 0.875rem;
}

.font-size-btn-large {
  font-size: 1rem;
}

.font-size-btn-xl {
  font-size: 1.125rem;
}

/* ============================================================
   TRANSITIONS - Consolidated with accessibility support
   ============================================================
   All transitions are disabled when user prefers reduced motion.
   This improves battery life and respects accessibility preferences.
   ============================================================ */

@media (prefers-reduced-motion: no-preference) {
  /* Theme-aware containers - smooth color transitions during theme changes */
  body,
  .sudoku-board,
  .game-container,
  header,
  main {
    transition: background-color 150ms ease-in-out,
                border-color 150ms ease-in-out,
                color 150ms ease-in-out;
  }

  /* Sudoku cells - background transitions for selection/hover feedback */
  .sudoku-cell {
    transition: background-color 150ms ease-in-out;
  }

  /* Control buttons - interactive feedback */
  .control-digit-btn,
  .control-action-btn,
  .control-action-btn-compact,
  .control-action-btn-labeled,
  .font-size-btn {
    transition: background-color 150ms ease-in-out,
                border-color 150ms ease-in-out,
                color 150ms ease-in-out,
                transform 150ms ease-in-out;
  }
}
